[[Synthesis start]]
	File: ../data/sqlsynthesizer/textbook_5_2_6
	Enumerator: StagedEnumerator
[[Retry]] Trying to search for depth: 0
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 115 [SymTable]: 117
[NaturalJoin]: 1 [SymTable]: 118
[Total Number of Intermediate] 118
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[[Retry]] Trying to search for depth: 1
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 5 [SymTable]: 7
[JOIN] level 1 [SymTable]: 22
[EnumJoinOnAggr] level 1 [SymTable]: 71
[Total Number of Intermediate] 71
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 10 [SymTable]: 12
[JOIN] level 1 [SymTable]: 37
[EnumJoinOnAggr] level 1 [SymTable]: 181
[Total Number of Intermediate] 181
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 10 [SymTable]: 12
[JOIN] level 1 [SymTable]: 37
[EnumJoinOnAggr] level 1 [SymTable]: 181
[Total Number of Intermediate] 181
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 10 [SymTable]: 12
[JOIN] level 1 [SymTable]: 37
[EnumJoinOnAggr] level 1 [SymTable]: 181
[Total Number of Intermediate] 181
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 15 [SymTable]: 17
[JOIN] level 1 [SymTable]: 52
[EnumJoinOnAggr] level 1 [SymTable]: 341
[Total Number of Intermediate] 341
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 558 [SymTable]: 560
[JOIN] level 1 [SymTable]: 1681
[EnumJoinOnAggr] level 1 [SymTable]: 315281
[Total Number of Intermediate] 315281
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 115 [SymTable]: 117
[JOIN] level 1 [SymTable]: 352
[EnumJoinOnAggr] level 1 [SymTable]: 14041
[Total Number of Intermediate] 14041
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[[Retry]] Trying to search for depth: 2
@output
part_key(StringVal) | sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 5 [SymTable]: 7
[JOIN] level 1 [SymTable]: 22
[JOIN] level 2 [SymTable]: 50
[UNION] level 1 [SymTable]: 52
[EnumLeftJoin] level 1 [SymTable]: 74
[EnumLeftJoinWAggr] level 1 [SymTable]: 96
[EnumAggrOnJoin]  [SymTable]: 2402
[EnumJoinOnAggr] level 1 [SymTable]: 2451
[EnumJoinOnAggr] level 2 [SymTable]: 2794
[EnumAggrOnAggr Then Join] level 1 [SymTable]: 2822
[Total Number of Intermediate] 2822
Candidate Tree Number: 0
[Enumeration Finished] Does not find a query in the search space.
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 10 [SymTable]: 12
[JOIN] level 1 [SymTable]: 37
[JOIN] level 2 [SymTable]: 85
[Total Number of Intermediate] 85
Candidate Tree Number: 5
[Enumeration Finished]
[Initialize Enumeration]
  Parameterized Table Number: 2368
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 2
[Aggregation]: 458 [SymTable]: 460
[NaturalJoin]: 1 [SymTable]: 461
[Total Number of Intermediate] 461
Candidate Tree Number: 5
[Enumeration Finished]
[Query No.10]===============================
SELECT
  [T31101].part_key,[T31101].sname
FROM
  (( SELECT
        [T31099].part_key,[T31099].MAX-cost,[T31099].sid,[T31099].part_key1,[T31099].cost
      FROM
        (( (SELECT
                [T31097].part_key, MAX([T31097].cost)
              FROM
                (input1) AS [T31097][sid, part_key, cost]
              GROUP BY
                [T31097].part_key) AS [T31098][part_key, MAX-cost] ) JOIN (
            input1 )) AS [T31099][part_key, MAX-cost, sid, part_key1, cost]
      WHERE
        [T31099].part_key == [T31099].part_key1
         AND [T31099].MAX-cost <= [T31099].cost ) JOIN (
      input2 )) AS [T31101][part_key, MAX-cost, sid, part_key1, cost, sid1, sname]
WHERE
  [T31101].sid == [T31101].sid1
@anonymous
[T31101].part_key(StringVal) | [T31101].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.9]===============================
SELECT
  [T33939].part_key,[T33939].sname
FROM
  (( SELECT
        input1.sid,input1.part_key,input1.cost
      FROM
        input1
      WHERE
        EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.cost > [T31103].cost) AS [T31152][sid, part_key, cost])
         AND NOT EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.part_key == [T31103].part_key
               AND input1.cost < [T31103].cost) AS [T31440][sid, part_key, cost]) ) JOIN (
      input2 )) AS [T33939][sid, part_key, cost, sid1, sname]
WHERE
  [T33939].sid == [T33939].sid1
@anonymous
[T33939].part_key(StringVal) | [T33939].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P4 | SN1 
P3 | SN4 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.8]===============================
SELECT
  [T31093].part_key,[T31093].sname
FROM
  (( SELECT
        [T31091].part_key,[T31091].MAX-cost,[T31091].sid,[T31091].part_key1,[T31091].cost
      FROM
        (( (SELECT
                [T31089].part_key, MAX([T31089].cost)
              FROM
                (input1) AS [T31089][sid, part_key, cost]
              GROUP BY
                [T31089].part_key) AS [T31090][part_key, MAX-cost] ) JOIN (
            SELECT
              input1.sid,input1.part_key,input1.cost
            FROM
              input1
            WHERE
              True )) AS [T31091][part_key, MAX-cost, sid, part_key1, cost]
      WHERE
        [T31091].part_key == [T31091].part_key1
         AND [T31091].MAX-cost == [T31091].cost ) JOIN (
      SELECT
        input2.sid,input2.sname
      FROM
        input2
      WHERE
        True )) AS [T31093][part_key, MAX-cost, sid, part_key1, cost, sid1, sname]
WHERE
  [T31093].sid == [T31093].sid1
@anonymous
[T31093].part_key(StringVal) | [T31093].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.7]===============================
SELECT
  [T33937].part_key,[T33937].sname
FROM
  (( SELECT
        input1.sid,input1.part_key,input1.cost
      FROM
        input1
      WHERE
        IS NULL input1.cost
         OR NOT EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.part_key == [T31103].part_key
               AND input1.cost < [T31103].cost) AS [T31440][sid, part_key, cost]) ) JOIN (
      SELECT
        input2.sid,input2.sname
      FROM
        input2
      WHERE
        True )) AS [T33937][sid, part_key, cost, sid1, sname]
WHERE
  [T33937].sid == [T33937].sid1
@anonymous
[T33937].part_key(StringVal) | [T33937].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P4 | SN1 
P3 | SN4 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.6]===============================
SELECT
  [T33933].part_key,[T33933].sname
FROM
  (( SELECT
        input1.sid,input1.part_key,input1.cost
      FROM
        input1
      WHERE
        NOT EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.part_key == [T31103].part_key
               AND input1.cost < [T31103].cost) AS [T31440][sid, part_key, cost]) ) JOIN (
      SELECT
        input2.sid,input2.sname
      FROM
        input2
      WHERE
        True )) AS [T33933][sid, part_key, cost, sid1, sname]
WHERE
  [T33933].sid == [T33933].sid1
@anonymous
[T33933].part_key(StringVal) | [T33933].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P4 | SN1 
P3 | SN4 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.5]===============================
SELECT
  [T31085].part_key,[T31085].sname
FROM
  (( SELECT
        [T31083].part_key,[T31083].MAX-cost,[T31083].sid,[T31083].part_key1,[T31083].cost
      FROM
        (( (SELECT
                [T31081].part_key, MAX([T31081].cost)
              FROM
                (input1) AS [T31081][sid, part_key, cost]
              GROUP BY
                [T31081].part_key) AS [T31082][part_key, MAX-cost] ) JOIN (
            input1 )) AS [T31083][part_key, MAX-cost, sid, part_key1, cost]
      WHERE
        [T31083].part_key == [T31083].part_key1
         AND [T31083].MAX-cost == [T31083].cost ) JOIN (
      SELECT
        input2.sid,input2.sname
      FROM
        input2
      WHERE
        True )) AS [T31085][part_key, MAX-cost, sid, part_key1, cost, sid1, sname]
WHERE
  [T31085].sid == [T31085].sid1
@anonymous
[T31085].part_key(StringVal) | [T31085].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.4]===============================
SELECT
  [T31077].part_key,[T31077].sname
FROM
  (( SELECT
        [T31075].part_key,[T31075].MAX-cost,[T31075].sid,[T31075].part_key1,[T31075].cost
      FROM
        (( (SELECT
                [T31073].part_key, MAX([T31073].cost)
              FROM
                (input1) AS [T31073][sid, part_key, cost]
              GROUP BY
                [T31073].part_key) AS [T31074][part_key, MAX-cost] ) JOIN (
            SELECT
              input1.sid,input1.part_key,input1.cost
            FROM
              input1
            WHERE
              True )) AS [T31075][part_key, MAX-cost, sid, part_key1, cost]
      WHERE
        [T31075].part_key == [T31075].part_key1
         AND [T31075].MAX-cost == [T31075].cost ) JOIN (
      input2 )) AS [T31077][part_key, MAX-cost, sid, part_key1, cost, sid1, sname]
WHERE
  [T31077].sid == [T31077].sid1
@anonymous
[T31077].part_key(StringVal) | [T31077].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.3]===============================
SELECT
  [T33935].part_key,[T33935].sname
FROM
  (( SELECT
        input1.sid,input1.part_key,input1.cost
      FROM
        input1
      WHERE
        IS NULL input1.cost
         OR NOT EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.part_key == [T31103].part_key
               AND input1.cost < [T31103].cost) AS [T31440][sid, part_key, cost]) ) JOIN (
      input2 )) AS [T33935][sid, part_key, cost, sid1, sname]
WHERE
  [T33935].sid == [T33935].sid1
@anonymous
[T33935].part_key(StringVal) | [T33935].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P4 | SN1 
P3 | SN4 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.2]===============================
SELECT
  [T33931].part_key,[T33931].sname
FROM
  (( SELECT
        input1.sid,input1.part_key,input1.cost
      FROM
        input1
      WHERE
        NOT EXIST (
          (SELECT
              [T31103].sid,[T31103].part_key,[T31103].cost
            FROM
              (input1) AS [T31103][sid, part_key, cost]
            WHERE
              input1.part_key == [T31103].part_key
               AND input1.cost < [T31103].cost) AS [T31440][sid, part_key, cost]) ) JOIN (
      input2 )) AS [T33931][sid, part_key, cost, sid1, sname]
WHERE
  [T33931].sid == [T33931].sid1
@anonymous
[T33931].part_key(StringVal) | [T33931].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P4 | SN1 
P3 | SN4 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[Query No.1]===============================
SELECT
  [T31069].part_key,[T31069].sname
FROM
  (( SELECT
        [T31067].part_key,[T31067].MAX-cost,[T31067].sid,[T31067].part_key1,[T31067].cost
      FROM
        (( (SELECT
                [T31065].part_key, MAX([T31065].cost)
              FROM
                (input1) AS [T31065][sid, part_key, cost]
              GROUP BY
                [T31065].part_key) AS [T31066][part_key, MAX-cost] ) JOIN (
            input1 )) AS [T31067][part_key, MAX-cost, sid, part_key1, cost]
      WHERE
        [T31067].part_key == [T31067].part_key1
         AND [T31067].MAX-cost == [T31067].cost ) JOIN (
      input2 )) AS [T31069][part_key, MAX-cost, sid, part_key1, cost, sid1, sname]
WHERE
  [T31069].sid == [T31069].sid1
@anonymous
[T31069].part_key(StringVal) | [T31069].sname(StringVal) 
P1 | SN2 
P2 | SN1 
P3 | SN4 
P4 | SN1 
P5 | SN3 
P6 | SN3 
P7 | SN1 
P8 | SN2 
P9 | SN3 

[[Synthesis Status]] Succeeded
[[Synthesis Time]] 47.644s
