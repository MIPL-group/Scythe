[[Synthesis start]]
	File: ../data/dev_set/021
	Enumerator: StagedEnumerator
[Retry] Maximum Depth: 1
[Initialize Enumeration]
  Parameterized Table Number: 0
[Enumeration Start]
[Basic]: 0 [SymTableForInputs]: Intermediate: 1
[Aggregation]: 98 [SymTable]: 99
[EnumJoinOnAggr] level 1 [SymTable]: 9900
Candidate Tree Number: 1546
[Enumeration Finished]
[No.20]===============================
SELECT
  [T7533].Customer,[T7533].shop
FROM
  (( SELECT
        [T7522].ZIP,[T7522].shop,[T7522].COUNT-Customer
      FROM
        (SELECT
            [T7521].ZIP, [T7521].shop, COUNT([T7521].Customer)
          FROM
            (input1) AS [T7521][Customer, email, ZIP, shop]
          GROUP BY
            [T7521].ZIP  [T7521].shop) AS [T7522][ZIP, shop, COUNT-Customer]
      WHERE
        [T7522].COUNT-Customer == 1.0 ) JOIN (
      (SELECT
          [T7531].Customer, [T7531].email, [T7531].ZIP, COUNT([T7531].shop)
        FROM
          (input1) AS [T7531][Customer, email, ZIP, shop]
        GROUP BY
          [T7531].Customer  [T7531].email  [T7531].ZIP) AS [T7532][Customer, email, ZIP, COUNT-shop] )) AS [T7533][ZIP, shop, COUNT-Customer, Customer, email, ZIP1, COUNT-shop]
WHERE
  [T7533].ZIP == [T7533].ZIP1
@anonymous
[T7533].Customer(StringVal) | [T7533].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.19]===============================
SELECT
  [T7359].Customer,[T7359].shop
FROM
  (( SELECT
        [T7348].ZIP,[T7348].shop,[T7348].COUNT-shop
      FROM
        (SELECT
            [T7347].ZIP, [T7347].shop, COUNT([T7347].shop)
          FROM
            (input1) AS [T7347][Customer, email, ZIP, shop]
          GROUP BY
            [T7347].ZIP  [T7347].shop) AS [T7348][ZIP, shop, COUNT-shop]
      WHERE
        [T7348].COUNT-shop == 1.0 ) JOIN (
      (SELECT
          [T7357].Customer, [T7357].ZIP, COUNT([T7357].email)
        FROM
          (input1) AS [T7357][Customer, email, ZIP, shop]
        GROUP BY
          [T7357].Customer  [T7357].ZIP) AS [T7358][Customer, ZIP, COUNT-email] )) AS [T7359][ZIP, shop, COUNT-shop, Customer, ZIP1, COUNT-email]
WHERE
  [T7359].ZIP == [T7359].ZIP1
@anonymous
[T7359].Customer(StringVal) | [T7359].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.18]===============================
SELECT
  [T7249].Customer,[T7249].shop
FROM
  (( SELECT
        [T7238].ZIP,[T7238].shop,[T7238].COUNT-ZIP
      FROM
        (SELECT
            [T7237].ZIP, [T7237].shop, COUNT([T7237].ZIP)
          FROM
            (input1) AS [T7237][Customer, email, ZIP, shop]
          GROUP BY
            [T7237].ZIP  [T7237].shop) AS [T7238][ZIP, shop, COUNT-ZIP]
      WHERE
        [T7238].COUNT-ZIP == 1.0 ) JOIN (
      (SELECT
          [T7247].Customer, [T7247].ZIP, COUNT([T7247].shop)
        FROM
          (input1) AS [T7247][Customer, email, ZIP, shop]
        GROUP BY
          [T7247].Customer  [T7247].ZIP) AS [T7248][Customer, ZIP, COUNT-shop] )) AS [T7249][ZIP, shop, COUNT-ZIP, Customer, ZIP1, COUNT-shop]
WHERE
  [T7249].ZIP == [T7249].ZIP1
@anonymous
[T7249].Customer(StringVal) | [T7249].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.17]===============================
SELECT
  [T6973].Customer,[T6973].shop
FROM
  (( SELECT
        [T6962].ZIP,[T6962].shop,[T6962].COUNT-Customer
      FROM
        (SELECT
            [T6961].ZIP, [T6961].shop, COUNT([T6961].Customer)
          FROM
            (input1) AS [T6961][Customer, email, ZIP, shop]
          GROUP BY
            [T6961].ZIP  [T6961].shop) AS [T6962][ZIP, shop, COUNT-Customer]
      WHERE
        [T6962].COUNT-Customer == 1.0 ) JOIN (
      (SELECT
          [T6971].Customer, [T6971].email, [T6971].ZIP, FROM
          (input1) AS [T6971][Customer, email, ZIP, shop]
        GROUP BY
          [T6971].Customer  [T6971].email  [T6971].ZIP) AS [T6972][Customer, email, ZIP] )) AS [T6973][ZIP, shop, COUNT-Customer, Customer, email, ZIP1]
WHERE
  [T6973].ZIP == [T6973].ZIP1
@anonymous
[T6973].Customer(StringVal) | [T6973].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.16]===============================
SELECT
  [T6323].Customer,[T6323].shop
FROM
  (( SELECT
        [T6312].ZIP,[T6312].shop,[T6312].COUNT-shop
      FROM
        (SELECT
            [T6311].ZIP, [T6311].shop, COUNT([T6311].shop)
          FROM
            (input1) AS [T6311][Customer, email, ZIP, shop]
          GROUP BY
            [T6311].ZIP  [T6311].shop) AS [T6312][ZIP, shop, COUNT-shop]
      WHERE
        [T6312].COUNT-shop == 1.0 ) JOIN (
      (SELECT
          [T6321].Customer, [T6321].ZIP, COUNT([T6321].shop)
        FROM
          (input1) AS [T6321][Customer, email, ZIP, shop]
        GROUP BY
          [T6321].Customer  [T6321].ZIP) AS [T6322][Customer, ZIP, COUNT-shop] )) AS [T6323][ZIP, shop, COUNT-shop, Customer, ZIP1, COUNT-shop1]
WHERE
  [T6323].ZIP == [T6323].ZIP1
@anonymous
[T6323].Customer(StringVal) | [T6323].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.15]===============================
SELECT
  [T6133].Customer,[T6133].shop
FROM
  (( SELECT
        [T6122].ZIP,[T6122].shop,[T6122].COUNT-shop
      FROM
        (SELECT
            [T6121].ZIP, [T6121].shop, COUNT([T6121].shop)
          FROM
            (input1) AS [T6121][Customer, email, ZIP, shop]
          GROUP BY
            [T6121].ZIP  [T6121].shop) AS [T6122][ZIP, shop, COUNT-shop]
      WHERE
        [T6122].COUNT-shop == 1.0 ) JOIN (
      (SELECT
          [T6131].Customer, [T6131].email, [T6131].ZIP, COUNT([T6131].email)
        FROM
          (input1) AS [T6131][Customer, email, ZIP, shop]
        GROUP BY
          [T6131].Customer  [T6131].email  [T6131].ZIP) AS [T6132][Customer, email, ZIP, COUNT-email] )) AS [T6133][ZIP, shop, COUNT-shop, Customer, email, ZIP1, COUNT-email]
WHERE
  [T6133].ZIP == [T6133].ZIP1
@anonymous
[T6133].Customer(StringVal) | [T6133].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.14]===============================
SELECT
  [T5933].Customer,[T5933].shop
FROM
  (( (SELECT
          [T5921].Customer, [T5921].email, [T5921].ZIP, COUNT([T5921].email)
        FROM
          (input1) AS [T5921][Customer, email, ZIP, shop]
        GROUP BY
          [T5921].Customer  [T5921].email  [T5921].ZIP) AS [T5922][Customer, email, ZIP, COUNT-email] ) JOIN (
      SELECT
        [T5932].ZIP,[T5932].shop,[T5932].COUNT-ZIP
      FROM
        (SELECT
            [T5931].ZIP, [T5931].shop, COUNT([T5931].ZIP)
          FROM
            (input1) AS [T5931][Customer, email, ZIP, shop]
          GROUP BY
            [T5931].ZIP  [T5931].shop) AS [T5932][ZIP, shop, COUNT-ZIP]
      WHERE
        [T5932].COUNT-ZIP == 1.0 )) AS [T5933][Customer, email, ZIP, COUNT-email, ZIP1, shop, COUNT-ZIP]
WHERE
  [T5933].ZIP == [T5933].ZIP1
@anonymous
[T5933].Customer(StringVal) | [T5933].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.13]===============================
SELECT
  [T5589].Customer,[T5589].shop
FROM
  (( (SELECT
          [T5577].Customer, [T5577].ZIP, COUNT([T5577].ZIP)
        FROM
          (input1) AS [T5577][Customer, email, ZIP, shop]
        GROUP BY
          [T5577].Customer  [T5577].ZIP) AS [T5578][Customer, ZIP, COUNT-ZIP] ) JOIN (
      SELECT
        [T5588].ZIP,[T5588].shop,[T5588].COUNT-shop
      FROM
        (SELECT
            [T5587].ZIP, [T5587].shop, COUNT([T5587].shop)
          FROM
            (input1) AS [T5587][Customer, email, ZIP, shop]
          GROUP BY
            [T5587].ZIP  [T5587].shop) AS [T5588][ZIP, shop, COUNT-shop]
      WHERE
        [T5588].COUNT-shop == 1.0 )) AS [T5589][Customer, ZIP, COUNT-ZIP, ZIP1, shop, COUNT-shop]
WHERE
  [T5589].ZIP == [T5589].ZIP1
@anonymous
[T5589].Customer(StringVal) | [T5589].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.12]===============================
SELECT
  [T5321].Customer,[T5321].shop
FROM
  (( (SELECT
          [T5309].Customer, [T5309].email, [T5309].ZIP, COUNT([T5309].email)
        FROM
          (input1) AS [T5309][Customer, email, ZIP, shop]
        GROUP BY
          [T5309].Customer  [T5309].email  [T5309].ZIP) AS [T5310][Customer, email, ZIP, COUNT-email] ) JOIN (
      SELECT
        [T5320].ZIP,[T5320].shop,[T5320].COUNT-email
      FROM
        (SELECT
            [T5319].ZIP, [T5319].shop, COUNT([T5319].email)
          FROM
            (input1) AS [T5319][Customer, email, ZIP, shop]
          GROUP BY
            [T5319].ZIP  [T5319].shop) AS [T5320][ZIP, shop, COUNT-email]
      WHERE
        [T5320].COUNT-email == 1.0 )) AS [T5321][Customer, email, ZIP, COUNT-email, ZIP1, shop, COUNT-email1]
WHERE
  [T5321].ZIP == [T5321].ZIP1
@anonymous
[T5321].Customer(StringVal) | [T5321].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.11]===============================
SELECT
  [T4743].Customer,[T4743].shop
FROM
  (( (SELECT
          [T4731].Customer, [T4731].ZIP, COUNT([T4731].Customer)
        FROM
          (input1) AS [T4731][Customer, email, ZIP, shop]
        GROUP BY
          [T4731].Customer  [T4731].ZIP) AS [T4732][Customer, ZIP, COUNT-Customer] ) JOIN (
      SELECT
        [T4742].ZIP,[T4742].shop,[T4742].COUNT-shop
      FROM
        (SELECT
            [T4741].ZIP, [T4741].shop, COUNT([T4741].shop)
          FROM
            (input1) AS [T4741][Customer, email, ZIP, shop]
          GROUP BY
            [T4741].ZIP  [T4741].shop) AS [T4742][ZIP, shop, COUNT-shop]
      WHERE
        [T4742].COUNT-shop == 1.0 )) AS [T4743][Customer, ZIP, COUNT-Customer, ZIP1, shop, COUNT-shop]
WHERE
  [T4743].ZIP == [T4743].ZIP1
@anonymous
[T4743].Customer(StringVal) | [T4743].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.10]===============================
SELECT
  [T4509].Customer,[T4509].shop
FROM
  (( (SELECT
          [T4497].Customer, [T4497].email, [T4497].ZIP, COUNT([T4497].Customer)
        FROM
          (input1) AS [T4497][Customer, email, ZIP, shop]
        GROUP BY
          [T4497].Customer  [T4497].email  [T4497].ZIP) AS [T4498][Customer, email, ZIP, COUNT-Customer] ) JOIN (
      SELECT
        [T4508].ZIP,[T4508].shop,[T4508].COUNT-ZIP
      FROM
        (SELECT
            [T4507].ZIP, [T4507].shop, COUNT([T4507].ZIP)
          FROM
            (input1) AS [T4507][Customer, email, ZIP, shop]
          GROUP BY
            [T4507].ZIP  [T4507].shop) AS [T4508][ZIP, shop, COUNT-ZIP]
      WHERE
        [T4508].COUNT-ZIP == 1.0 )) AS [T4509][Customer, email, ZIP, COUNT-Customer, ZIP1, shop, COUNT-ZIP]
WHERE
  [T4509].ZIP == [T4509].ZIP1
@anonymous
[T4509].Customer(StringVal) | [T4509].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.9]===============================
SELECT
  [T4089].Customer,[T4089].shop
FROM
  (( SELECT
        [T4078].ZIP,[T4078].shop,[T4078].COUNT-email
      FROM
        (SELECT
            [T4077].ZIP, [T4077].shop, COUNT([T4077].email)
          FROM
            (input1) AS [T4077][Customer, email, ZIP, shop]
          GROUP BY
            [T4077].ZIP  [T4077].shop) AS [T4078][ZIP, shop, COUNT-email]
      WHERE
        [T4078].COUNT-email == 1.0 ) JOIN (
      (SELECT
          [T4087].Customer, [T4087].ZIP, COUNT([T4087].email)
        FROM
          (input1) AS [T4087][Customer, email, ZIP, shop]
        GROUP BY
          [T4087].Customer  [T4087].ZIP) AS [T4088][Customer, ZIP, COUNT-email] )) AS [T4089][ZIP, shop, COUNT-email, Customer, ZIP1, COUNT-email1]
WHERE
  [T4089].ZIP == [T4089].ZIP1
@anonymous
[T4089].Customer(StringVal) | [T4089].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.8]===============================
SELECT
  [T3943].Customer,[T3943].shop
FROM
  (( SELECT
        [T3932].ZIP,[T3932].shop,[T3932].COUNT-shop
      FROM
        (SELECT
            [T3931].ZIP, [T3931].shop, COUNT([T3931].shop)
          FROM
            (input1) AS [T3931][Customer, email, ZIP, shop]
          GROUP BY
            [T3931].ZIP  [T3931].shop) AS [T3932][ZIP, shop, COUNT-shop]
      WHERE
        [T3932].COUNT-shop == 1.0 ) JOIN (
      (SELECT
          [T3941].Customer, [T3941].ZIP, FROM
          (input1) AS [T3941][Customer, email, ZIP, shop]
        GROUP BY
          [T3941].Customer  [T3941].ZIP) AS [T3942][Customer, ZIP] )) AS [T3943][ZIP, shop, COUNT-shop, Customer, ZIP1]
WHERE
  [T3943].ZIP == [T3943].ZIP1
@anonymous
[T3943].Customer(StringVal) | [T3943].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.7]===============================
SELECT
  [T3603].Customer,[T3603].shop
FROM
  (( SELECT
        [T3592].ZIP,[T3592].shop,[T3592].COUNT-email
      FROM
        (SELECT
            [T3591].ZIP, [T3591].shop, COUNT([T3591].email)
          FROM
            (input1) AS [T3591][Customer, email, ZIP, shop]
          GROUP BY
            [T3591].ZIP  [T3591].shop) AS [T3592][ZIP, shop, COUNT-email]
      WHERE
        [T3592].COUNT-email == 1.0 ) JOIN (
      (SELECT
          [T3601].Customer, [T3601].ZIP, COUNT([T3601].shop)
        FROM
          (input1) AS [T3601][Customer, email, ZIP, shop]
        GROUP BY
          [T3601].Customer  [T3601].ZIP) AS [T3602][Customer, ZIP, COUNT-shop] )) AS [T3603][ZIP, shop, COUNT-email, Customer, ZIP1, COUNT-shop]
WHERE
  [T3603].ZIP == [T3603].ZIP1
@anonymous
[T3603].Customer(StringVal) | [T3603].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.6]===============================
SELECT
  [T3493].Customer,[T3493].shop
FROM
  (( SELECT
        [T3482].ZIP,[T3482].shop,[T3482].COUNT-ZIP
      FROM
        (SELECT
            [T3481].ZIP, [T3481].shop, COUNT([T3481].ZIP)
          FROM
            (input1) AS [T3481][Customer, email, ZIP, shop]
          GROUP BY
            [T3481].ZIP  [T3481].shop) AS [T3482][ZIP, shop, COUNT-ZIP]
      WHERE
        [T3482].COUNT-ZIP == 1.0 ) JOIN (
      (SELECT
          [T3491].Customer, [T3491].ZIP, COUNT([T3491].Customer)
        FROM
          (input1) AS [T3491][Customer, email, ZIP, shop]
        GROUP BY
          [T3491].Customer  [T3491].ZIP) AS [T3492][Customer, ZIP, COUNT-Customer] )) AS [T3493][ZIP, shop, COUNT-ZIP, Customer, ZIP1, COUNT-Customer]
WHERE
  [T3493].ZIP == [T3493].ZIP1
@anonymous
[T3493].Customer(StringVal) | [T3493].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.5]===============================
SELECT
  [T2909].Customer,[T2909].shop
FROM
  (( SELECT
        [T2898].ZIP,[T2898].shop,[T2898].COUNT-ZIP
      FROM
        (SELECT
            [T2897].ZIP, [T2897].shop, COUNT([T2897].ZIP)
          FROM
            (input1) AS [T2897][Customer, email, ZIP, shop]
          GROUP BY
            [T2897].ZIP  [T2897].shop) AS [T2898][ZIP, shop, COUNT-ZIP]
      WHERE
        [T2898].COUNT-ZIP == 1.0 ) JOIN (
      (SELECT
          [T2907].Customer, [T2907].ZIP, COUNT([T2907].ZIP)
        FROM
          (input1) AS [T2907][Customer, email, ZIP, shop]
        GROUP BY
          [T2907].Customer  [T2907].ZIP) AS [T2908][Customer, ZIP, COUNT-ZIP] )) AS [T2909][ZIP, shop, COUNT-ZIP, Customer, ZIP1, COUNT-ZIP1]
WHERE
  [T2909].ZIP == [T2909].ZIP1
@anonymous
[T2909].Customer(StringVal) | [T2909].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.4]===============================
SELECT
  [T2409].Customer,[T2409].shop
FROM
  (( SELECT
        [T2398].ZIP,[T2398].shop,[T2398].COUNT-shop
      FROM
        (SELECT
            [T2397].ZIP, [T2397].shop, COUNT([T2397].shop)
          FROM
            (input1) AS [T2397][Customer, email, ZIP, shop]
          GROUP BY
            [T2397].ZIP  [T2397].shop) AS [T2398][ZIP, shop, COUNT-shop]
      WHERE
        [T2398].COUNT-shop == 1.0 ) JOIN (
      (SELECT
          [T2407].Customer, [T2407].email, [T2407].ZIP, COUNT([T2407].shop)
        FROM
          (input1) AS [T2407][Customer, email, ZIP, shop]
        GROUP BY
          [T2407].Customer  [T2407].email  [T2407].ZIP) AS [T2408][Customer, email, ZIP, COUNT-shop] )) AS [T2409][ZIP, shop, COUNT-shop, Customer, email, ZIP1, COUNT-shop1]
WHERE
  [T2409].ZIP == [T2409].ZIP1
@anonymous
[T2409].Customer(StringVal) | [T2409].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.3]===============================
SELECT
  [T2179].Customer,[T2179].shop
FROM
  (( SELECT
        [T2168].ZIP,[T2168].shop,[T2168].COUNT-Customer
      FROM
        (SELECT
            [T2167].ZIP, [T2167].shop, COUNT([T2167].Customer)
          FROM
            (input1) AS [T2167][Customer, email, ZIP, shop]
          GROUP BY
            [T2167].ZIP  [T2167].shop) AS [T2168][ZIP, shop, COUNT-Customer]
      WHERE
        [T2168].COUNT-Customer == 1.0 ) JOIN (
      (SELECT
          [T2177].Customer, [T2177].ZIP, COUNT([T2177].ZIP)
        FROM
          (input1) AS [T2177][Customer, email, ZIP, shop]
        GROUP BY
          [T2177].Customer  [T2177].ZIP) AS [T2178][Customer, ZIP, COUNT-ZIP] )) AS [T2179][ZIP, shop, COUNT-Customer, Customer, ZIP1, COUNT-ZIP]
WHERE
  [T2179].ZIP == [T2179].ZIP1
@anonymous
[T2179].Customer(StringVal) | [T2179].shop(NumberVal) 
John Smith | 1.0 
Mary King | 2.0 
John Smith | 3.0 
Mary King | 5.0 
John Smith | 5.0 

[No.2]===============================
SELECT
  [T1959].Customer,[T1959].shop
FROM
  (( (SELECT
          [T1947].Customer, [T1947].ZIP, COUNT([T1947].email)
        FROM
          (input1) AS [T1947][Customer, email, ZIP, shop]
        GROUP BY
          [T1947].Customer  [T1947].ZIP) AS [T1948][Customer, ZIP, COUNT-email] ) JOIN (
      SELECT
        [T1958].ZIP,[T1958].shop,[T1958].COUNT-email
      FROM
        (SELECT
            [T1957].ZIP, [T1957].shop, COUNT([T1957].email)
          FROM
            (input1) AS [T1957][Customer, email, ZIP, shop]
          GROUP BY
            [T1957].ZIP  [T1957].shop) AS [T1958][ZIP, shop, COUNT-email]
      WHERE
        [T1958].COUNT-email == 1.0 )) AS [T1959][Customer, ZIP, COUNT-email, ZIP1, shop, COUNT-email1]
WHERE
  [T1959].ZIP == [T1959].ZIP1
@anonymous
[T1959].Customer(StringVal) | [T1959].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[No.1]===============================
SELECT
  [T1535].Customer,[T1535].shop
FROM
  (( (SELECT
          [T1523].Customer, [T1523].ZIP, COUNT([T1523].shop)
        FROM
          (input1) AS [T1523][Customer, email, ZIP, shop]
        GROUP BY
          [T1523].Customer  [T1523].ZIP) AS [T1524][Customer, ZIP, COUNT-shop] ) JOIN (
      SELECT
        [T1534].ZIP,[T1534].shop,[T1534].COUNT-email
      FROM
        (SELECT
            [T1533].ZIP, [T1533].shop, COUNT([T1533].email)
          FROM
            (input1) AS [T1533][Customer, email, ZIP, shop]
          GROUP BY
            [T1533].ZIP  [T1533].shop) AS [T1534][ZIP, shop, COUNT-email]
      WHERE
        [T1534].COUNT-email == 1.0 )) AS [T1535][Customer, ZIP, COUNT-shop, ZIP1, shop, COUNT-email]
WHERE
  [T1535].ZIP == [T1535].ZIP1
@anonymous
[T1535].Customer(StringVal) | [T1535].shop(NumberVal) 
John Smith | 1.0 
John Smith | 3.0 
John Smith | 5.0 
Mary King | 2.0 
Mary King | 5.0 

[[Synthesis Status]] Succeeded
[[Synthesis Time]] 9.401s
