//http://stackoverflow.com/questions/15969614/in-sql-how-to-select-the-top-2-rows-for-each-group
////MOD: 4

#input

| NAME  | SCORE |
|---------------|
| willy |    11 |
| willy |    21 |
| willy |    31 |
| zoe   |    41 |
| zoe   |    51 |
| zoe   |    61 |
|  d    |    11  |

#output

| NAME  | SCORE |
|---------------|
| willy |    21 |
| willy |    31 |
| zoe   |    51 |
| zoe   |    61 |
|  d    |    11  |


#constraint
{
	"constants": ["2"],
	"aggregation_functions": ["count"]
}

#solution

SELECT *
FROM   test s
WHERE 
        (
            SELECT  COUNT(*) 
            FROM    test  f
            WHERE f.name = s.name AND 
                  f.score >= s.score
        ) <= 2;

select x.*
from test x join test y
where x.score < y.score and x.name = y.name
group by x.name, x.score, y.name
having count(*) <=2;